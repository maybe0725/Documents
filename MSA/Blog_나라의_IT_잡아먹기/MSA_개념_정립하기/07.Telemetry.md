# [MSA 개념 정립하기] Telemetry

<br/>

출처 - [나라의 IT 잡아먹기 / [MSA 개념 정립하기] Telemetry](https://waspro.tistory.com/443?category=857035)

<br/>

본 포스팅에서는 Monitoring과 Diagnostics를 관리하는 Telemetry에 대해 알아보겠습니다.

마이크로서비스 아키텍처에서 Telemetry는 다양하게 발생가능한 이슈를 대비하기 위해 반드시 필요한 요소입니다.
분산 환경내에서는 이슈가 발생할 경우 Root cause를 밝히는데 어려움이 있습니다.
각 서비스별 발생가능한 이슈를 Composition하여 Tracing 해 나가는 다양한 리소스가 필요한 이유입니다.
Monitoring, Logging을 포함하여 Alerting 기능과 각 서비스 간 Tracing이 가능한 도구를 제공하여 지속적이고 효과적으로 모니터링하고 이슈에 대응할 수 있도록 하는 것이 중요합니다.

대표적인 제품으로

|                    |                                              오픈소스 직접 구현                                              |                           상용 솔루션 활용                            |      Public Cloud 서비스      |
| :----------------: | :----------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------: | :---------------------------: |
| 모니터링/로깅/분석 | ELK, Grafana, Graphite, <br/>Splunk, Fluentd, Logstash, <br/>Kibana, Prometheus, Jaeger, <br/>Zipkin, Squash | Datadog, Elastic, Sysdig, <br/>AppDynamics, Dynatrace, <br/>New Relic | AWS CloudWatch, Azure Monitor |

등이 있습니다.

MSA를 선도적으로 도입한 기업에게 자체적으로 만들어낸 솔루션을 포함하여 수많은 오픈소스 솔루션이 존재합니다.
전통적인 APM 벤더들이 빠르게 마이크로서비스용도의 상용제품을 내놓고 있는 상황입니다.

<br/>

**1) Telemetry 주요 기능**

① Monitoring

모니터링은 MSA 구조에서 대상의 성능이나 효율성을 확인하는 서비스로, AWS에서는 AWS CloudWatch가 있고, OSS로는 Prometheus등이 있습니다.
모니터링은 각 대상에게서 수집한 Metric을 통해 대상 리소스의 사용률 등을 수치로 표현하는 기능을 수행합니다.

<br/>

② Logging

Logging은 MSA 구조에서 대상의 log들을 수집해서 보여주는 서비스로, AWS에서는 AWS ElasticSearch가 있고, OSS로는 EFK 혹은 ELK가 있습니다.
각 대상에 배포된 Agent 역할을 하는 forwarder들이 로그를 수집해 aggregator가 그 로그를 쉬합하고, aggregator가 취합한 로그를 저장한 것을 Kibana등의 Visualization tool을 사용해 사용자 혹은 관리자에게 보여줍니다.

ex) Log aggregation, storage and analysis tools - for example, AWS CloudWatch, Microsoft Azure Monitor, Datadog, Elastic (ELK — ElasticCache/Logstash/Kibana), Google Stackdriver, Grafana, Graphite, Loggly, Prometheus, RisingStack Trace, Scalyr, Sensu, SignalFx, Splunk, Sysdig and VMware Wavefront

<br/>

③ Tracing

Tracing은 MSA 구조에서 Event를 일어난 순서대로 나열해서 보여주는 서비스입니다.
AWS에서는 AWS X-Ray가 있고, OSS로는 Zipkin이나 Jaeger, Spring Cloud Sleuth, OpenTracing 등이 있습니다.
시간 순으로 요청을 보여주고 어떤 단계에서 성공 혹은 실패를 했는지 보여주기 때문에, MSA에서 어떤 부분에 오류가 발생했는지를 쉽게 파악할 수 있습니다.

<br/>
